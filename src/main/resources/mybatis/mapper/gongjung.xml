<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="gongjung">

	<!-- 입출고 삭제현황 조회 -->
	<select id="getIpChulDeleteList" parameterType="gongjung" resultType="gongjung">
		SET LOCK_TIMEOUT 10000;
		WITH DEL_NUMS AS
		(
		SELECT ROW_NUMBER() OVER
		(ORDER BY ${sidx} ${sord}) AS 'ROWNUM',
		CONVERT(char(10), DEL_DATE, 23)
		as DEL_DATE,
		CONVERT(char(10), ORD_DATE, 23) as ORD_DATE,
		CONVERT(char(10), OCH_DATE, 23) as OCH_DATE,
		DEL_ID,DEL_KIND,
		CORP_NAME, PROD_NAME,PROD_NO,PROD_GYU, DEL_SU, DEL_AMNT, ORD_LOT ,
		SESSION_NAME
		FROM DEL_LOG WITH(NOLOCK)
		<where>
			DEL_DATE BETWEEN #{strtDate}+' 00:00:00' AND #{endDate}+' 23:59:59'
			<if test="DEL_DATE != null">
				AND DEL_DATE = #{del_date}
			</if>
			<if test="delgubn != '전체'">
				AND DEL_KIND = #{del_gubn}
			</if>
			<if test="CORP_NAME != null">
				AND CORP_NAME like '%'+#{corp_name}+'%'
			</if>
			<if test="PROD_NAME != null">
				AND PROD_NAME like '%'+#{prod_name}+'%'
			</if>
			<if test="PROD_NO != null">
				AND PROD_NO like '%'+#{prod_no}+'%'
			</if>
			<if test="PROD_GYU != null">
				AND PROD_GYU like '%'+#{prod_gyu}+'%'
			</if>
			<if test="DEL_SU != null">
				AND DEL_SU = #{del_su}
			</if>
			<if test="DEL_AMNT != null">
				AND DEL_AMNT = #{del_amnt}
			</if>
			<if test="del_reg != null">
				AND SESSION_NAME like '%'+#{del_reg}+'%'
			</if>
			and DEL_KIND != '제품등록'
		</where>
		)
		SELECT ROWNUM, *
		FROM DEL_NUMS WITH(NOLOCK)
		WHERE ROWNUM BETWEEN
		${start} AND ${end}
	</select>



</mapper>